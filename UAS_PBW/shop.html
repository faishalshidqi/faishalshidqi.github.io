<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Keranjang Belanja</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script type="text/javascript" src="js/jquery-1.3.2.js"></script>
    <script type="text/javascript" src="js/jquery.livequery.js"></script>

    <script type="text/javascript">
        $(document).ready(function() {

            const Arrays = [];

            // mendeteksi pergerakan mouse
            $('.wrap li').mousemove(function(){
                const position = $(this).position();
                $('#cart').stop().animate({
                                              left   : position.left+'px',
                                          },250,function(){
                });
            }).mouseout(function () {

            });

            // menambahkan jumlah barang di keranjang
            // mengirim objek yang diklik di display ke dalam keranjang
            $('.wrap li').click(function(){

                let prev_charges;
                const thisID = $(this).attr('id');

                const itemname = $(this).find('div .name').html();
                const itemprice = $(this).find('div .price').html();

                if(include(Arrays,thisID))
                {
                    const price = $('#each-' + thisID).children(".shopp-price").find('em').html();
                    let quantity = $('#each-' + thisID).children(".shopp-quantity").html();
                    quantity = parseInt(quantity) + 1;

                    const total = parseInt(itemprice) * parseInt(quantity);

                    $('#each-'+thisID).children(".shopp-price").find('em').html(total);
                    $('#each-'+thisID).children(".shopp-quantity").html(quantity);

                    prev_charges = $('.cart-total span').html();
                    prev_charges = parseInt(prev_charges) - parseInt(price);

                    prev_charges = parseInt(prev_charges) + total;
                    $('.cart-total span').html(prev_charges);

                    $('#total-hidden-charges').val(prev_charges);
                }
                else
                {
                    Arrays.push(thisID);

                    prev_charges = $('.cart-total span').html();
                    prev_charges = parseInt(prev_charges)+parseInt(itemprice);

                    $('.cart-total span').html(prev_charges);
                    $('#total-hidden-charges').val(prev_charges);

                    $('#left_bar .cart-info').append('<div class="shopp" id="each-'+thisID+'"><div class="label">'+itemname+'</div><div class="shopp-price"> Rp.<em>'+itemprice+'</em></div><span class="shopp-quantity">1</span><img src="remove.png" class="remove" /><br class="all" /></div>');

                    $('#cart').css({'-webkit-transform' : 'rotate(20deg)','-moz-transform' : 'rotate(20deg)' });
                }

                setTimeout('angle()',200);
            });

            // menghapus barang dari keranjang
            // mengurangi total harga sejumlah yang dihapus
            $('.remove').livequery('click', function() {

                const deduct = $(this).parent().children(".shopp-price").find('em').html();
                let prev_charges = $('.cart-total span').html();

                const thisID = $(this).parent().attr('id').replace('each-', '');

                const pos = getpos(Arrays, thisID);
                Arrays.splice(pos,1,"0")

                prev_charges = parseInt(prev_charges)-parseInt(deduct);
                $('.cart-total span').html(prev_charges);
                $('#total-hidden-charges').val(prev_charges);
                $(this).parent().remove();

            });

            // menampilkan total harga yang harus dibayar
            $('#Submit').livequery('click', function() {

                const totalCharge = $('#total-hidden-charges').val();

                $('#left_bar').html('Total Harga: Rp. '+totalCharge);

                return false;

            });

        });


        function include(arr, obj) {
            for(let i=0; i < arr.length; i++) {
                if (arr[i] === obj) return true;
            }
        }

        function getpos(arr, obj) {
            for(let i=0; i < arr.length; i++) {
                if (arr[i] === obj) return i;
            }
        }
    </script>

</head>
<body>
<header>
    <h1>TOKO BUNGA CANTIK</h1>
</header>
<nav>
    <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="About.html">About</a></li>
        <li><a href="#">Belanja</a></li>
    </ul>
</nav>
<div class="menu">
    <ul>
        <li> <a href="belanjaAglonema.html">
            <img src="img/aglaonema_kategori.jpg" alt="Aglonema">
            Aglonema
        </a> </li>
        <li> <a href="belanjaCaladium.html">
            <img src="img/caladium_kategori.jpg" alt="Caladium">
            Caladium
        </a> </li>
        <li> <a href="belanjaMonstrea.html">
            <img src="img/monstrea_kategori.jpg" alt="Monstera">
            Monstrea
        </a> </li>
    </ul>
</div>
<!--<div id="sidebar">
    <h2>Price</h2>
    <ul class="left_menu">
        <div id="left_bar">

            <form action="#" id="cart_form" name="cart_form">

                <div class="cart-info"></div>

                <div class="cart-total">

                    <b>Total Charges:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b> Rp.<span>0</span>

                    <input type="hidden" name="total-hidden-charges" id="total-hidden-charges" value="0" />
                </div>

                <button type="submit" id="Submit">CheckOut</button>

            </form>

        </div> </ul>
</div>-->
<div class="col-h-3 col-11 col-n-8 content">
    <h2 style="text-align: center">PRODUK TERLARIS</h2>
    <div class="row">
        <div class="column">
            <a href="" style="width:100%">
                <img src="img/aglonemaSuksom.jpg" alt="Aglonema Suksom" class="items"><br>
                <span class="name">Aglonema Suksom </span><br>
                <span class="price">Rp 140,000<br></span>
            </a>
        </div>
        <!--<li id="1">
            <img src="gambar/aglonemaSuksom.jpg" class="items" height="100" alt="" />

            <br clear="all" />
            <div><span class="name">Aglonema Suksom</span> <br> Rp. <span class="price">140000</span> </div>
        </li>-->
        <div class="column">
            <a href="" style="width:100%">
                <img src="img/aglonemaVenus.jpg" alt="Aglonema Venus"><br>
                Aglonema Venus<br>
                Rp 140,000<br>
            </a>
        </div>
        <div class="column">
            <a href="" style="width:100%">
                <img src="img/Caladium_fiesta.jpg" alt="Caladium Fiesta"><br>
                Caladium Fiesta<br>
                Rp 140,000<br>
            </a>
        </div>
    </div>
    <div class="row">
        <div class="column">
            <a href="" style="width:100%">
                <img src="img/Caladium_pink_love.jpg" alt="Caladium Pink Love"><br>
                Caladium Pink Love<br>
                Rp 140,000<br>
            </a>
        </div>
        <div class="column">
            <a href="" style="width:100%">
                <img src="img/Monstera_Deliciosa.jpg" alt="Monstera Deliciosa"><br>
                Monstera Deliciosa<br>
                Rp 140,000<br>
            </a>
        </div>
        <div class="column">
            <a href="" style="width:100%">
                <img src="img/Monstera_Adansonii.jpg" alt="Monstera Adansonii"><br>
                Monstera Adansonii<br>
                Rp 140,000<br>
            </a>
        </div>

    </div>
</div>
<footer>
    Copyright &copy;2021 Muhammad Faishal Shidqi
</footer>
</body>
</html>